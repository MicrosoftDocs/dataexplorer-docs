%%{ init: { 'flowchart': {'defaultRenderer': 'elk' } } }%%
graph TD
    %% Real Entities from BloodHound_Entra dataset
    JACOB[John Jacob<br/>AZUser<br/>admin_tier_0<br/>jjacob@phantomcorp.onmicrosoft.com]
    
    %% Groups he owns
    ALLUSERS[All Users<br/>AZGroup<br/>ID: 2f061293]
    GAROLE[ThisGroupHasGARoleAlwaysActive<br/>AZGroup<br/>ID: 4c8435bf]
    
    %% App he owns
    AZUREHOUND[AzureHoundEnterprise<br/>AZApp<br/>ID: 5595629b]
    
    %% Device he owns
    WIN10[AADJoinedWin10<br/>AZDevice<br/>ID: 2a2dc5ab]
    
    %% Administrative Role
    GLOBALADMIN[Global Administrator<br/>AZRole<br/>Privileged Role]
    
    %% Tenant
    PHANTOM[Phantom Corp<br/>AZTenant<br/>phantomcorp.onmicrosoft.com]
    
    %% Validated Relationships
    JACOB -->|AZOwns<br/>Application Owner| AZUREHOUND
    JACOB -->|AZOwns<br/>Group Owner| ALLUSERS
    JACOB -->|AZOwns<br/>Group Owner| GAROLE
    JACOB -->|AZOwns<br/>Device Owner| WIN10
    
    %% Administrative Privileges
    GLOBALADMIN -->|AZResetPassword<br/>Can Reset| JACOB
    
    %% Tenant Containment
    PHANTOM -->|AZContains<br/>Tenant Member| JACOB
    
    %% Styling
    classDef user fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
    classDef app fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px
    classDef group fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef device fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef role fill:#ffebee,stroke:#d32f2f,stroke-width:3px
    classDef tenant fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    
    class JACOB user
    class AZUREHOUND app
    class ALLUSERS,GAROLE group
    class WIN10 device
    class GLOBALADMIN role
    class PHANTOM tenant